{% extends "dashboard/base.html" %}

{% block title %}Dashboard - Admin Panel{% endblock %}

{% block page_title %}Dashboard Overview{% endblock %}

{% block content %}
<div class="page-header">
    <h1>Welcome back, {{ user.first_name }}!</h1>
    <p>Here's what's happening with your platform today.</p>
</div>

<!-- Statistics Cards -->
<div class="row g-4 mb-4">
    <div class="col-md-3">
        <div class="stat-card primary">
            <div class="icon">
                <i class="bi bi-receipt"></i>
            </div>
            <div class="value">{{ stats.total_orders }}</div>
            <div class="label">Total Orders</div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="stat-card warning">
            <div class="icon">
                <i class="bi bi-clock-history"></i>
            </div>
            <div class="value">{{ stats.pending_orders }}</div>
            <div class="label">Pending Orders</div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="stat-card success">
            <div class="icon">
                <i class="bi bi-check-circle"></i>
            </div>
            <div class="value">{{ stats.completed_orders }}</div>
            <div class="label">Completed Orders</div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="stat-card primary">
            <div class="icon">
                <i class="bi bi-currency-dollar"></i>
            </div>
            <div class="value">${{ "%.2f"|format(stats.total_revenue) }}</div>
            <div class="label">Total Revenue</div>
        </div>
    </div>
</div>

<div class="row g-4 mb-4">
    <div class="col-md-3">
        <div class="stat-card success">
            <div class="icon">
                <i class="bi bi-shop"></i>
            </div>
            <div class="value">{{ stats.active_restaurants }}</div>
            <div class="label">Active Restaurants</div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="stat-card danger">
            <div class="icon">
                <i class="bi bi-hourglass-split"></i>
            </div>
            <div class="value">{{ stats.pending_approvals }}</div>
            <div class="label">Pending Approvals</div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="stat-card primary">
            <div class="icon">
                <i class="bi bi-geo-alt"></i>
            </div>
            <div class="value">{{ stats.total_cities }}</div>
            <div class="label">Cities</div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="stat-card warning">
            <div class="icon">
                <i class="bi bi-bicycle"></i>
            </div>
            <div class="value">{{ stats.active_riders }}</div>
            <div class="label">Active Riders</div>
        </div>
    </div>
</div>

<!-- Recent Orders -->
<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="mb-0">Recent Orders</h5>
                <a href="/api/v1/dashboard/orders" class="btn btn-sm btn-primary">View All</a>
            </div>
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-hover mb-0">
                        <thead>
                            <tr>
                                <th>Order ID</th>
                                <th>Customer</th>
                                <th>Restaurant</th>
                                <th>Status</th>
                                <th>Total</th>
                                <th>Date</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% if stats.recent_orders %}
                                {% for order in stats.recent_orders %}
                                <tr>
                                    <td><strong>#{{ order.id }}</strong></td>
                                    <td>{{ order.customer_name }}</td>
                                    <td>Restaurant #{{ order.restaurant_id }}</td>
                                    <td>
                                        {% if order.status.value == 'created' %}
                                            <span class="badge bg-secondary">Created</span>
                                        {% elif order.status.value == 'confirmed' %}
                                            <span class="badge bg-info">Confirmed</span>
                                        {% elif order.status.value == 'preparing' %}
                                            <span class="badge bg-warning">Preparing</span>
                                        {% elif order.status.value == 'ready' %}
                                            <span class="badge bg-primary">Ready</span>
                                        {% elif order.status.value == 'assigned' %}
                                            <span class="badge bg-info">Assigned</span>
                                        {% elif order.status.value == 'picked_up' %}
                                            <span class="badge bg-warning">Picked Up</span>
                                        {% elif order.status.value == 'delivered' %}
                                            <span class="badge bg-success">Delivered</span>
                                        {% elif order.status.value == 'cancelled' %}
                                            <span class="badge bg-danger">Cancelled</span>
                                        {% else %}
                                            <span class="badge bg-secondary">{{ order.status.value }}</span>
                                        {% endif %}
                                    </td>
                                    <td><strong>${{ "%.2f"|format(order.total) }}</strong></td>
                                    <td>{{ order.created_at.strftime('%Y-%m-%d %H:%M') }}</td>
                                </tr>
                                {% endfor %}
                            {% else %}
                                <tr>
                                    <td colspan="6" class="text-center py-4 text-muted">
                                        <i class="bi bi-inbox" style="font-size: 2rem;"></i>
                                        <br>No recent orders
                                    </td>
                                </tr>
                            {% endif %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Quick Actions -->
<div class="row mt-4">
    <div class="col-md-4">
        <div class="card">
            <div class="card-body text-center">
                <i class="bi bi-shop text-primary" style="font-size: 3rem;"></i>
                <h5 class="mt-3">Approve Restaurants</h5>
                <p class="text-muted">Review and approve pending restaurant applications</p>
                <a href="/api/v1/dashboard/restaurants?pending_only=true" class="btn btn-primary">
                    Review Pending ({{ stats.pending_approvals }})
                </a>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card">
            <div class="card-body text-center">
                <i class="bi bi-people text-success" style="font-size: 3rem;"></i>
                <h5 class="mt-3">Manage User Roles</h5>
                <p class="text-muted">Assign roles and permissions to users</p>
                <a href="/api/v1/dashboard/user-roles" class="btn btn-success">Manage Roles</a>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card">
            <div class="card-body text-center">
                <i class="bi bi-geo-alt text-warning" style="font-size: 3rem;"></i>
                <h5 class="mt-3">Manage Cities</h5>
                <p class="text-muted">Add or configure operational cities</p>
                <a href="/api/v1/dashboard/cities" class="btn btn-warning">Manage Cities</a>
            </div>
        </div>
    </div>
</div>

{% endblock %}

